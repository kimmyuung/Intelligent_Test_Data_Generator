---
description: 데이터 분석 및 학습 기능 워크플로우 (Python ML Server)
---

# 데이터 분석 및 학습 워크플로우

이 워크플로우는 사용자가 보유한 샘플 데이터를 업로드하여 패턴을 분석하고, 이를 기반으로 더 정교한 테스트 데이터를 생성하는 과정을 설명합니다.

## 1. 아키텍처 및 기술 스텍
- **Module**: `itdg-ml-server`
- **Language**: Python 3.9+
- **Framework**: FastAPI, Uvicorn
- **Libraries**: Pandas (분석), OpenPyXL (Excel), Python-Multipart (업로드)

## 2. 파일 업로드 및 검증 프로세스

### 2.1 프론트엔드 검증 (1차)
- **허용 확장자**: `.csv`, `.json`, `.xls`, `.xlsx`
- **검증 로직**: 파일 선택 시 정규식(`/\.(csv|json|xlsx?)$/i`)으로 확장자를 검사합니다.
- **예외 처리**: 허용되지 않은 형식일 경우 즉시 `alert` 창을 띄우고 업로드를 중단합니다.

### 2.2 서버 저장 및 라이프사이클 (2차)
1.  **임시 저장**: 업로드된 파일은 서버의 `temp/` 디렉토리에 고유 ID(UUID)로 저장됩니다.
2.  **분석 수행**: 저장된 파일을 `Pandas`로 로드하여 통계 분석을 수행합니다.
3.  **결과 반환**: 분석 결과(메타데이터)와 함께 `fileId`를 클라이언트에 반환합니다.

## 3. 파일 삭제 정책 (Cleanup)
보안 및 리소스 관리를 위해 업로드된 파일은 영구 저장되지 않습니다.

1.  **자동 삭제 (Auto-Cleanup)**
    - 백그라운드 스레드가 1분 주기로 `temp/` 폴더를 모니터링합니다.
    - 생성된 지 **30분**이 지난 파일은 "고아 파일(Orphaned File)"로 간주하여 자동 삭제합니다.
    - 이는 사용자가 분석만 하고 브라우저를 닫거나 이탈했을 때를 대비한 안전 장치입니다.

2.  **명시적 삭제 (Explicit Cleanup)**
    - 사용자가 데이터 생성을 완료하면, 클라이언트가 `/api/cleanup/{fileId}`를 호출하여 즉시 삭제합니다.

## 4. API 명세

### `POST /api/v1/analyze`
- **Request**: `Multipart/Form-Data` (Validation: 확장자 체크)
- **Process**: 저장 -> 분석 -> 메타데이터 추출
- **Response**:
    ```json
    {
      "fileId": "uuid-string",
      "stats": {
        "columnName": { "type": "numeric", "min": 0, "max": 100, ... }
      }
    }
    ```

### `DELETE /api/v1/cleanup/{fileId}`
- **Process**: `temp/` 디렉토리에서 해당 파일 즉시 삭제
